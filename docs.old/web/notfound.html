<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="UTF-8">
    <title>NetCore by Bigsby - Not found page in AstNet .Core Web Applicaiton in Visual Studio Code</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="../stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="../stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="../stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="../stylesheets/prism.css">
    <script src="../scripts/prism.js"></script>
</head>

<body>
    <section class="page-header">
        <h1 class="project-name">NetCore</h1>
        <h2 class="project-tagline">Testing cross-platform of .Net Core</h2>
        <a href="../index.html" class="btn">Home of Series</a>
    </section>

    <section class="main-content">
        <h1>Adding not found page to ASP.Net Core application in Visual Studio Code</h1>

        <p>As we've seen before, when no middleware handles an HTTP request, the fallback handle defined in "app.Run()" in "Startup.cs" "Configure" method is invoked. To change the response for a not found resource, this generic handler needs to be changed.</p>

        <p>Note: If no fallback handler is set, Asp.Net Core return a NotFound (404) HTTP Code to the client without any content.</p>

        <p>To return a file in the fallback hander, these steps need to be follwed:</p>

        <ol>
            <li>
                <h4>Add a not found file</h4>
                <p>Add a file to "wwwroot" folder, name it "notfound.html" and set this as its content:</p>
                <pre class="line-numbers"><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Not found resource&lt;/title&gt;
        &lt;meta charset="utf-8"/&gt;
    &lt;/head&gt;
    
    &lt;body&gt;
        You are requesting &lt;span style="color: red"&gt;a resource that does not exist or is not configured&lt;/span&gt; in this &lt;b&gt;Asp.Net Core Web Application&lt;/b&gt;!
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
            </li>
            <li>
                <h4>Configure returning the file</h4>
                <p>As we've seen before, we need to tell the fallback handler to return the "not found" page by changing the "app.Run()" method in "Startup.cs" "Configure()" method. The whole file will look like this:</p>
                <pre class="line-numbers"><code class="language-csharp">using Microsoft.AspNetCore.Builder;
using Microsoft.AspNetCore.Hosting;
using Microsoft.AspNetCore.Http;
using Microsoft.Extensions.DependencyInjection;
namespace webApp
{
    public class Startup
    {
        // This method gets called by the runtime. Use this method to add services to the container.
        // For more information on how to configure your application, visit https://go.microsoft.com/fwlink/?LinkID=398940
        public void ConfigureServices(IServiceCollection services)
        {
        }
        // This method gets called by the runtime. Use this method to configure the HTTP request pipeline.
        public void Configure(IApplicationBuilder app)
        {
            var defaultFilesOptions = new DefaultFilesOptions();
            defaultFilesOptions.DefaultFileNames.Clear();
            defaultFilesOptions.DefaultFileNames.Add("index.html");
            app.UseDefaultFiles(defaultFilesOptions);
            
            app.UseStaticFiles();
            
            app.Run(async (context) =>
            {
                await context.Response.SendFileAsync("wwwroot/notfound.html");
            });
        }
    }
}
</code></pre>
            </li>
            <li>
                <h4>Test not found fallback</h4>
                <p>Hit <kbd>F5</kbd> to run the project and, after the browser opens the default document, change the URL in the address bar adding gibberish to it like <a href="http://localhost:5000/asdfasd">http://localhost:5000/asdfasd</a>. The result should be the content of the "notfound.html" file with the HTML styling:</p>
                <code>
                    You are requesting <span style="color: red">a resource that does not exist or is not configured</span> in this <b>Asp.Net Core Web Application</b>!
                </code>
            </li>
        </ol>

        <a href="../index.html#mvc"><h3>Next -> Add an MVC Controller</h3></a>
    </section>

    <section class="page-header">
        <a href="../index.html" class="btn">Home of Series</a>
    </section>
</body>
</html>
